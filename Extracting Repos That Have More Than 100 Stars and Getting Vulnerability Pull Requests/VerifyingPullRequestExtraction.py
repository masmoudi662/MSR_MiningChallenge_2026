import pandas as pd

security_prs = pd.read_csv("security_prs.csv")
summary = pd.read_csv("security_prs_summary.csv")

print("Rows in CSV:", len(security_prs))
print(summary)

# Check if any PR IDs repeat (shouldn't happen)
duplicates = security_prs[security_prs.duplicated("pr_id", keep=False)]
print("Duplicate PR IDs:", len(duplicates))

# Check how many distinct PRs have CVE/CWE IDs
cve_count = security_prs["matched_ids"].fillna("").str.contains("CVE-", case=False).sum()
cwe_count = security_prs["matched_ids"].fillna("").str.contains("CWE-", case=False).sum()
print(f"PRs mentioning CVE: {cve_count}, CWE: {cwe_count}")

# Quick top keyword overview
top_terms = (
    security_prs["matched_terms"]
    .dropna()
    .str.split(";")
    .explode()
    .str.lower()
    .value_counts()
    .head(20)
)
print("\nTop 20 matched security terms:\n", top_terms)
